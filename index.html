<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Internal Affairs Dashboard ‚Äî Advanced Red Theme</title>
<style>
  /* Fonts & Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  body {
    margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    background: #fff5f5;
    color: #3a0b0b;
    line-height: 1.5;
    min-height: 100vh;
    padding: 1rem;
  }
  h1, h2 {
    color: #8b0000;
    margin-bottom: 0.3rem;
  }
  h1 {
    font-size: 2rem;
    text-align: center;
    font-weight: 700;
  }
  h2 {
    font-size: 1.4rem;
    border-bottom: 2px solid #b22222;
    padding-bottom: 0.2rem;
  }
  .container {
    max-width: 900px;
    margin: 0 auto 3rem;
    background: #ffe5e5;
    border-radius: 15px;
    padding: 1.5rem 2rem;
    box-shadow: 0 4px 15px rgba(139,0,0,0.25);
  }
  /* Buttons */
  button {
    cursor: pointer;
    background-color: #b22222;
    color: white;
    border: none;
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    border-radius: 10px;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  button:hover {
    background-color: #8b0000;
  }
  /* Inputs */
  input[type="text"], input[type="date"], select, textarea {
    font-size: 1rem;
    padding: 0.4rem 0.6rem;
    border-radius: 8px;
    border: 1.5px solid #b22222;
    width: 100%;
    margin-top: 0.3rem;
    margin-bottom: 1rem;
    outline-offset: 2px;
  }
  input[type="checkbox"] {
    transform: scale(1.3);
    margin-right: 0.5rem;
    cursor: pointer;
  }
  label {
    font-weight: 600;
  }
  /* Progress Bar */
  .progress-container {
    background: #f9d6d6;
    border-radius: 20px;
    height: 25px;
    overflow: hidden;
    margin-bottom: 1rem;
    box-shadow: inset 0 2px 4px #aa4b4b;
  }
  .progress-bar {
    background: #b22222;
    height: 100%;
    width: 0%;
    transition: width 0.5s ease-in-out;
    border-radius: 20px 0 0 20px;
  }
  .progress-text {
    text-align: center;
    font-weight: 700;
    margin-bottom: 1rem;
    color: #660000;
    font-size: 1.1rem;
  }
  /* Table styles */
  table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 12px;
  }
  thead tr {
    background-color: #8b0000;
    color: white;
    font-weight: 700;
    border-radius: 12px;
  }
  thead th {
    padding: 0.8rem 0.5rem;
    text-align: left;
  }
  tbody tr {
    background: #fff0f0;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(178,34,34,0.15);
  }
  tbody td {
    padding: 0.8rem 0.5rem;
    vertical-align: middle;
  }
  tbody td button {
    background: #cc4444;
    font-size: 0.9rem;
    padding: 0.3rem 0.8rem;
    border-radius: 8px;
  }
  tbody td button:hover {
    background: #a53030;
  }
  /* Badge styles */
  .badge {
    padding: 0.3rem 0.7rem;
    border-radius: 15px;
    font-weight: 700;
    color: white;
    display: inline-block;
    min-width: 80px;
    text-align: center;
    user-select: none;
  }
  .open { background: #dc3545; }      /* Bootstrap Danger Red */
  .pending { background: #fd7e14; }   /* Orange */
  .resolved { background: #28a745; }  /* Green */
  .closed { background: #6c757d; }    /* Gray */
  .overdue { background: #b22222; }
  .followup { background: #c82333; }
  /* Responsive layout */
  @media (max-width: 650px) {
    table, thead, tbody, tr, th, td {
      display: block;
      width: 100%;
    }
    thead tr {
      display: none;
    }
    tbody tr {
      margin-bottom: 1.2rem;
      border-radius: 15px;
      box-shadow: 0 3px 15px rgba(178,34,34,0.3);
      background: #ffe5e5;
      padding: 1rem;
    }
    tbody td {
      padding: 0.3rem 0;
      position: relative;
      padding-left: 45%;
      text-align: left;
      font-weight: 600;
      border-bottom: 1px solid #b22222;
    }
    tbody td::before {
      content: attr(data-label);
      position: absolute;
      left: 0.8rem;
      top: 50%;
      transform: translateY(-50%);
      font-weight: 700;
      color: #8b0000;
      white-space: nowrap;
    }
    tbody td button {
      margin-top: 0.8rem;
      width: 100%;
    }
  }
  /* Form section */
  form {
    background: #ffe5e5;
    border-radius: 15px;
    padding: 1rem 1.5rem;
    box-shadow: inset 0 0 10px #b22222;
    margin-top: 1.5rem;
  }
  form > div {
    margin-bottom: 1rem;
  }
  /* Officer list */
  .officer-list {
    margin-top: 1rem;
    padding: 0;
    list-style: none;
  }
  .officer-list li {
    background: #b22222;
    color: white;
    margin-bottom: 0.6rem;
    padding: 0.4rem 0.7rem;
    border-radius: 12px;
    font-weight: 600;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .officer-list li button {
    background: #8b0000;
    font-size: 0.8rem;
    padding: 0.2rem 0.5rem;
  }
  /* Bar chart for breakdown */
  .breakdown {
    margin-top: 1rem;
  }
  .breakdown-item {
    margin-bottom: 0.8rem;
  }
  .breakdown-label {
    font-weight: 700;
    margin-bottom: 0.2rem;
    color: #660000;
  }
  .breakdown-bar {
    height: 20px;
    background: #b22222;
    border-radius: 12px;
    width: 0;
    transition: width 0.5s ease;
  }
  /* Alerts */
  .alert {
    background: #ffe0e0;
    border: 1.5px solid #b22222;
    color: #660000;
    padding: 0.6rem 1rem;
    border-radius: 12px;
    font-weight: 700;
    margin-bottom: 1rem;
  }
  /* Footer */
  footer {
    text-align: center;
    color: #8b0000;
    font-size: 0.85rem;
    margin-top: 3rem;
  }
</style>
</head>
<body>

  <h1>üïµÔ∏è‚Äç‚ôÇÔ∏è Internal Affairs Dashboard</h1>

  <div class="container" aria-label="Progress overview">
    <h2>Progress Overview</h2>
    <div class="progress-text" id="progress-text">Loading progress...</div>
    <div class="progress-container" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="Case completion progress">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
  </div>

  <div class="container" aria-label="Cases management">
    <h2>Cases</h2>
    <table aria-describedby="cases-desc" aria-live="polite" id="cases-table" role="table">
      <caption id="cases-desc" class="sr-only">List of Internal Affairs cases with details</caption>
      <thead>
        <tr>
          <th scope="col">Case ID</th>
          <th scope="col">Type</th>
          <th scope="col">Status</th>
          <th scope="col">Assigned Officer</th>
          <th scope="col">Due Date</th>
          <th scope="col">Follow-up</th>
          <th scope="col" style="width: 100px;">Actions</th>
        </tr>
      </thead>
      <tbody id="cases-tbody">
        <!-- Rows populated by JS -->
      </tbody>
    </table>

    <form id="case-form" aria-label="Add or update a case">
      <h3 id="form-title">Add New Case</h3>
      <input type="hidden" id="edit-index" value="-1" />
      <div>
        <label for="case-id">Case ID</label>
        <input type="text" id="case-id" placeholder="E.g. IA-010" required maxlength="10" />
      </div>
      <div>
        <label for="case-type">Type</label>
        <select id="case-type" required>
          <option value="">Select type</option>
          <option value="Abuse of Power">Abuse of Power</option>
          <option value="Misconduct">Misconduct</option>
          <option value="Corruption">Corruption</option>
          <option value="Other">Other</option>
        </select>
      </div>
      <div>
        <label for="case-status">Status</label>
        <select id="case-status" required>
          <option value="">Select status</option>
          <option value="Open">Open</option>
          <option value="Pending">Pending</option>
          <option value="Resolved">Resolved</option>
          <option value="Closed">Closed</option>
        </select>
      </div>
      <div>
        <label for="case-officer">Assigned Officer</label>
        <input type="text" id="case-officer" placeholder="Officer name" required maxlength="30" />
      </div>
      <div>
        <label for="case-due">Due Date</label>
        <input type="date" id="case-due" required />
      </div>
      <div>
        <label><input type="checkbox" id="case-followup" /> Follow-up Required</label>
      </div>
      <button type="submit" id="form-submit">Add Case</button>
      <button type="button" id="form-cancel" style="display:none; margin-left: 10px; background:#660000;">Cancel Edit</button>
    </form>
  </div>

  <div class="container" aria-label="Case type breakdown">
    <h2>Case Breakdown by Type</h2>
    <div id="breakdown-container" class="breakdown" aria-live="polite" aria-atomic="true">
      <!-- Bar charts populated by JS -->
    </div>
  </div>

  <div class="container" aria-label="Officer management">
    <h2>Officers</h2>
    <ul id="officer-list" class="officer-list" aria-live="polite" aria-atomic="true">
      <!-- Officer items populated by JS -->
    </ul>
    <form id="officer-form" aria-label="Add new officer" style="margin-top:1rem;">
      <label for="officer-name">Add Officer</label>
      <input type="text" id="officer-name" placeholder="Officer name" maxlength="30" required />
      <button type="submit">Add Officer</button>
    </form>
  </div>

  <footer>
    <p>Advanced Internal Affairs Dashboard ‚Äî Red Theme UI/UX</p>
    <p>
      Data stored locally on your browser.<br />
      To persist data on server or sync with GitHub, integrate with backend or GitHub Actions.<br />
      Refresh page to reset data.
    </p>
  </footer>

<script>
  // Data arrays (load from localStorage or default)
  let cases = JSON.parse(localStorage.getItem('ia_cases')) || [
    {id:"IA-001", type:"Abuse of Power", status:"Open", officer:"Jane Doe", due:"2025-07-10", followup:true},
    {id:"IA-002", type:"Misconduct", status:"Closed", officer:"John Smith", due:"2025-06-28", followup:false},
    {id:"IA-003", type:"Corruption", status:"Pending", officer:"Alice Chen", due:"2025-07-12", followup:true},
  ];
  let officers = JSON.parse(localStorage.getItem('ia_officers')) || ["Jane Doe","John Smith","Alice Chen"];

  // Cached DOM
  const tbody = document.getElementById('cases-tbody');
  const progressBar = document.getElementById('progress-bar');
  const progressText = document.getElementById('progress-text');
  const breakdownContainer = document.getElementById('breakdown-container');
  const officerList = document.getElementById('officer-list');
  const caseForm = document.getElementById('case-form');
  const editIndexInput = document.getElementById('edit-index');
  const formTitle = document.getElementById('form-title');
  const formSubmitBtn = document.getElementById('form-submit');
  const formCancelBtn = document.getElementById('form-cancel');

  // Form inputs
  const caseIdInput = document.getElementById('case-id');
  const caseTypeInput = document.getElementById('case-type');
  const caseStatusInput = document.getElementById('case-status');
  const caseOfficerInput = document.getElementById('case-officer');
  const caseDueInput = document.getElementById('case-due');
  const caseFollowupInput = document.getElementById('case-followup');
  const officerNameInput = document.getElementById('officer-name');

  // Helper: Save to localStorage
  function saveData() {
    localStorage.setItem('ia_cases', JSON.stringify(cases));
    localStorage.setItem('ia_officers', JSON.stringify(officers));
  }

  // Render cases table
  function renderCases() {
    tbody.innerHTML = '';
    cases.forEach((c, idx) => {
      // Create row
      const tr = document.createElement('tr');

      // Case ID
      let tdId = document.createElement('td');
      tdId.textContent = c.id;
      tdId.setAttribute('data-label', 'Case ID');
      tr.appendChild(tdId);

      // Type
      let tdType = document.createElement('td');
      tdType.textContent = c.type;
      tdType.setAttribute('data-label', 'Type');
      tr.appendChild(tdType);

      // Status with badge
      let tdStatus = document.createElement('td');
      let spanBadge = document.createElement('span');
      spanBadge.className = 'badge ' + c.status.toLowerCase();
      spanBadge.textContent = c.status;
      tdStatus.setAttribute('data-label', 'Status');
      tdStatus.appendChild(spanBadge);
      tr.appendChild(tdStatus);

      // Assigned Officer
      let tdOfficer = document.createElement('td');
      tdOfficer.textContent = c.officer;
      tdOfficer.setAttribute('data-label', 'Assigned Officer');
      tr.appendChild(tdOfficer);

      // Due Date
      let tdDue = document.createElement('td');
      tdDue.textContent = c.due;
      tdDue.setAttribute('data-label', 'Due Date');
      // Check overdue: past due date & not resolved/closed
      const today = new Date().toISOString().slice(0,10);
      if (c.due < today && !['Resolved','Closed'].includes(c.status)) {
        tdDue.innerHTML += ' <span class="badge overdue" aria-label="Overdue case">‚ö†Ô∏è Overdue</span>';
      }
      tr.appendChild(tdDue);

      // Follow-up checkbox disabled
      let tdFollow = document.createElement('td');
      tdFollow.setAttribute('data-label', 'Follow-up');
      let checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.checked = c.followup;
      checkbox.disabled = true;
      checkbox.setAttribute('aria-label', `Follow-up required for ${c.id}`);
      tdFollow.appendChild(checkbox);
      tr.appendChild(tdFollow);

      // Actions: Edit / Delete
      let tdActions = document.createElement('td');
      tdActions.style.textAlign = 'center';

      // Edit button
      let btnEdit = document.createElement('button');
      btnEdit.textContent = 'Edit';
      btnEdit.setAttribute('aria-label', `Edit ${c.id}`);
      btnEdit.addEventListener('click', () => {
        loadCaseIntoForm(idx);
      });
      tdActions.appendChild(btnEdit);

      // Delete button
      let btnDelete = document.createElement('button');
      btnDelete.textContent = 'Delete';
      btnDelete.style.marginLeft = '6px';
      btnDelete.setAttribute('aria-label', `Delete ${c.id}`);
      btnDelete.addEventListener('click', () => {
        if (confirm(`Delete case ${c.id}? This action cannot be undone.`)) {
          cases.splice(idx,1);
          saveData();
          renderCases();
          renderProgress();
          renderBreakdown();
        }
      });
      tdActions.appendChild(btnDelete);

      tr.appendChild(tdActions);

      tbody.appendChild(tr);
    });
  }

  // Render progress bar
  function renderProgress() {
    const total = cases.length;
    const completed = cases.filter(c => ['Resolved', 'Closed'].includes(c.status)).length;
    const percent = total === 0 ? 0 : Math.round((completed / total) * 100);
    progressBar.style.width = percent + '%';
    progressText.textContent = `Completed ${completed} / ${total} cases (${percent}%)`;
    progressBar.parentElement.setAttribute('aria-valuenow', percent);
  }

  // Render breakdown by type
  function renderBreakdown() {
    // Count cases by type
    const counts = cases.reduce((acc, c) => {
      acc[c.type] = (acc[c.type] || 0) + 1;
      return acc;
    }, {});
    const types = ["Abuse of Power","Misconduct","Corruption","Other"];
    const maxCount = Math.max(...Object.values(counts),1);

    breakdownContainer.innerHTML = '';

    types.forEach(type => {
      const count = counts[type] || 0;
      const pct = Math.round((count / maxCount) * 100);
      const div = document.createElement('div');
      div.className = 'breakdown-item';
      div.innerHTML = `
        <div class="breakdown-label">${type} (${count})</div>
        <div class="breakdown-bar" style="width:${pct}%; background:#b22222"></div>
      `;
      breakdownContainer.appendChild(div);
    });
  }

  // Render officer list
  function renderOfficers() {
    officerList.innerHTML = '';
    officers.forEach((name, idx) => {
      const li = document.createElement('li');
      li.textContent = name;

      // Remove officer button
      const btnRemove = document.createElement('button');
      btnRemove.textContent = 'Remove';
      btnRemove.setAttribute('aria-label', `Remove officer ${name}`);
      btnRemove.addEventListener('click', () => {
        if(confirm(`Remove officer ${name}? This will unassign all their cases.`)) {
          // Unassign cases assigned to this officer
          cases.forEach(c => { if(c.officer === name) c.officer = 'Unassigned'; });
          officers.splice(idx, 1);
          saveData();
          renderCases();
          renderOfficers();
        }
      });
      li.appendChild(btnRemove);
      officerList.appendChild(li);
    });
  }

  // Load case into form for editing
  function loadCaseIntoForm(idx) {
    const c = cases[idx];
    editIndexInput.value = idx;
    caseIdInput.value = c.id;
    caseTypeInput.value = c.type;
    caseStatusInput.value = c.status;
    caseOfficerInput.value = c.officer;
    caseDueInput.value = c.due;
    caseFollowupInput.checked = c.followup;
    formTitle.textContent = `Edit Case ${c.id}`;
    formSubmitBtn.textContent = 'Update Case';
    formCancelBtn.style.display = 'inline-block';
    caseIdInput.focus();
  }

  // Reset form to "Add"
  function resetForm() {
    editIndexInput.value = -1;
    caseForm.reset();
    formTitle.textContent = 'Add New Case';
    formSubmitBtn.textContent = 'Add Case';
    formCancelBtn.style.display = 'none';
  }

  // Form submit handler
  caseForm.addEventListener('submit', e => {
    e.preventDefault();
    const idx = parseInt(editIndexInput.value, 10);
    const newCase = {
      id: caseIdInput.value.trim(),
      type: caseTypeInput.value,
      status: caseStatusInput.value,
      officer: caseOfficerInput.value.trim() || 'Unassigned',
      due: caseDueInput.value,
      followup: caseFollowupInput.checked
    };

    // Basic validation: unique case id for new cases
    if (idx === -1 && cases.some(c => c.id.toLowerCase() === newCase.id.toLowerCase())) {
      alert('Case ID must be unique.');
      return;
    }

    if(idx === -1) {
      cases.push(newCase);
    } else {
      cases[idx] = newCase;
    }
    saveData();
    renderCases();
    renderProgress();
    renderBreakdown();
    resetForm();
  });

  // Cancel edit
  formCancelBtn.addEventListener('click', () => {
    resetForm();
  });

  // Add officer form
  document.getElementById('officer-form').addEventListener('submit', e => {
    e.preventDefault();
    const name = officerNameInput.value.trim();
    if (!name) return alert('Enter officer name.');
    if (officers.includes(name)) {
      alert('Officer already exists.');
      return;
    }
    officers.push(name);
    saveData();
    renderOfficers();
    officerNameInput.value = '';
  });

  // Initialize
  function init() {
    renderCases();
    renderProgress();
    renderBreakdown();
    renderOfficers();
  }

  init();
</script>

</body>
</html>
